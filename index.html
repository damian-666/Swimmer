<!DOCTYPE html>
<html lang="en">
<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formaldehyde Molecule Oscillation</title>
    <style>
        body { margin: 0; }
        canvas { display: block; }
        .label {
            position: absolute;
            color: white;
            font-size: 12px;
            pointer-events: none;
        }
    </style>
</head>
<body>
 
    <script type="module">
        import * as THREE from "https://cdn.jsdelivr.net/npm/three@0.121.1/build/three.module.js";
        import { OrbitControls } from "https://cdn.jsdelivr.net/npm/three@0.121.1/examples/jsm/controls/OrbitControls.js";
      
        // Set up the scene, camera, and renderer
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer();
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

        // Set up camera position
        camera.position.z = 5;

        // Add orbit controls
        const controls = new THREE.OrbitControls(camera, renderer.domElement);

        // Add a light source
        const light = new THREE.PointLight(0xFFFFFF);
        light.position.set(10, 10, 10);
        scene.add(light);

        // Function to create a sphere representing an atom
        function createAtom(radius, color) {
            const geometry = new THREE.SphereGeometry(radius, 32, 32);
            const material = new THREE.MeshPhongMaterial({ color: color });
            return new THREE.Mesh(geometry, material);
        }

        // Create the formaldehyde molecule (C, O, H atoms)
        const carbon = createAtom(0.1, 0x000000);  // Black for Carbon
        carbon.position.set(0, 0, 0);
        const oxygen = createAtom(0.15, 0xFF0000); // Red for Oxygen
        oxygen.position.set(0, 0, 1.2);
        const hydrogen1 = createAtom(0.05, 0x00FF00); // Green for Hydrogen1
        hydrogen1.position.set(1.0, 0, -0.5);
        const hydrogen2 = createAtom(0.05, 0x00FF00); // Green for Hydrogen2
        hydrogen2.position.set(-1.0, 0, -0.5);

        // Add atoms to the scene
        scene.add(carbon);
        scene.add(oxygen);
        scene.add(hydrogen1);
        scene.add(hydrogen2);

        // Create labels for the atoms
        function createLabel(text, position) {
            const div = document.createElement('div');
            div.className = 'label';
            div.textContent = text;
            document.body.appendChild(div);
            return { element: div, position: position };
        }

        const labels = [
            createLabel('C', carbon.position),
            createLabel('O', oxygen.position),
            createLabel('H1', hydrogen1.position),
            createLabel('H2', hydrogen2.position)
        ];

        // Create lines connecting atoms
        function createBond(start, end) {
            const material = new THREE.LineBasicMaterial({ color: 0x000000 });
            const geometry = new THREE.BufferGeometry().setFromPoints([start, end]);
            return new THREE.Line(geometry, material);
        }

        // Add bonds
        let bonds = [];
        bonds.push(createBond(new THREE.Vector3(0, 0, 0), new THREE.Vector3(0, 0, 1.2))); // C-O bond
        bonds.push(createBond(new THREE.Vector3(0, 0, 0), new THREE.Vector3(1.0, 0, -0.5))); // C-H1 bond
        bonds.push(createBond(new THREE.Vector3(0, 0, 0), new THREE.Vector3(-1.0, 0, -0.5))); // C-H2 bond
        bonds.forEach(bond => scene.add(bond));

        // Function to create a sphere with geodesics
        function createGeodesicSphere(radius) {
            const geometry = new THREE.SphereGeometry(radius, 32, 32);
            const material = new THREE.MeshBasicMaterial({ color: 0xADD8E6, wireframe: true, opacity: 0.3, transparent: true });
            return new THREE.Mesh(geometry, material);
        }

        // Create the geodesic sphere
        const geodesicSphere = createGeodesicSphere(3);
        scene.add(geodesicSphere);

        // Function to update labels
        function updateLabels() {
            labels.forEach(label => {
                const vector = label.position.clone().project(camera);
                const x = (vector.x * 0.5 + 0.5) * window.innerWidth;
                const y = -(vector.y * 0.5 - 0.5) * window.innerHeight;
                label.element.style.transform = `translate(-50%, -50%) translate(${x}px,${y}px)`;
            });
        }

        // Function to animate the oscillation
        let angle = 0;
        function animate() {
            requestAnimationFrame(animate);

            // Oscillate the hydrogen atoms
            angle += 0.01;
            hydrogen1.position.set(1.0 * Math.cos(angle), 0, -0.5 * Math.sin(angle));
            hydrogen2.position.set(-1.0 * Math.cos(angle), 0, -0.5 * Math.sin(angle));

            // Update bonds
            bonds.forEach(bond => scene.remove(bond)); // Remove existing bonds
            bonds = [];
            bonds.push(createBond(new THREE.Vector3(0, 0, 0), new THREE.Vector3(0, 0, 1.2))); // C-O bond
            bonds.push(createBond(new THREE.Vector3(0, 0, 0), hydrogen1.position)); // Update C-H1 bond
            bonds.push(createBond(new THREE.Vector3(0, 0, 0), hydrogen2.position)); // Update C-H2 bond
            bonds.forEach(bond => scene.add(bond));

            controls.update();
            updateLabels();
            renderer.render(scene, camera);
        }

        animate();

<script>  src="http://threejs.org/build/three.min.js"></script>
<script> src="https://threejs.org/examples/js/controls/OrbitControls.js"></script>
<script src="https://threejs.org/examples/js/loaders/3MFLoader.js"></script>
<script src="https://threejs.org/examples/js/loaders/OBJLoader.js"></script>
<script src="https://threejs.org/examples/js/loaders/STLLoader.js"></script>

    </script>
</body>
</html>
